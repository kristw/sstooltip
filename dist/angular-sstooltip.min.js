!function(root,factory){"function"==typeof define&&define.amd?define(["jquery","angular","sstooltip"],factory):factory(root.$,root.angular,root.sstooltip)}(this,function($,angular,sstooltip){function safeApply(scope,fn){scope.$$phase||scope.$root.$$phase?fn():scope.$apply(fn)}function magic(fnOrObj,value,defaultValue){return $.isFunction(fnOrObj)?fnOrObj(value):fnOrObj?fnOrObj:defaultValue}var module=angular.module("sstooltip",[]);return module.directive("sstooltip",[function(){return{restrict:"AE",replace:!0,template:'<div style="position:relative"><div class="sstooltip"><div ng-if="tooltipText">{{tooltipText}}</div><div ng-if="tooltipSrc"><ng-include src="tooltipSrc"></ng-include></div></div></div>',scope:{tooltipKey:"@",tooltipSrc:"=",tooltipText:"="},link:function(scope,element,attrs){var tooltipElement=element[0].querySelector(".sstooltip"),tip=new sstooltip(tooltipElement);attrs.tooltipTheme&&$(tooltipElement).addClass("sstooltip-"+attrs.tooltipTheme),scope.$on("sstooltip:show",function(event,tooltipKey,data){tooltipKey==scope.tooltipKey&&(safeApply(scope,function(){scope.data=data.data}),tip.show(null,data.mouseEvent))}),scope.$on("sstooltip:move",function(event,tooltipKey,data){tooltipKey==scope.tooltipKey&&tip.show(null,data.mouseEvent)}),scope.$on("sstooltip:hide",function(){tip.hide()})}}}]),module.factory("sstooltipManager",[function(){return function($scope,tooltipKey){function triggerOnScopeEvents(triggerShowEvent,triggerMoveEvent,triggerHideEvent,dataFn,mouseEventFn){triggerShowEvent&&$scope.$on(triggerShowEvent,function(event,data){show(magic(mouseEventFn,data,data.mouseEvent),magic(dataFn,data,data.data))}),triggerMoveEvent&&$scope.$on(triggerMoveEvent,function(event,data){move(magic(mouseEventFn,data,data.mouseEvent),magic(dataFn,data,data.data))}),triggerHideEvent&&$scope.$on(triggerHideEvent,function(){hide()})}function triggerOnDomEvents(dom,triggerShowEvent,triggerMoveEvent,triggerHideEvent,dataFn){triggerShowEvent&&$(dom).on(triggerShowEvent,function(mouseEvent){show(mouseEvent,magic(dataFn,mouseEvent,mouseEvent.data))}),triggerMoveEvent&&$(dom).on(triggerMoveEvent,function(mouseEvent){move(mouseEvent,magic(dataFn,mouseEvent,mouseEvent.data))}),triggerHideEvent&&$(dom).on(triggerHideEvent,hide)}function show(mouseEvent,data){$scope.$broadcast("sstooltip:show",tooltipKey,{mouseEvent:mouseEvent,data:data})}function move(mouseEvent,data){$scope.$broadcast("sstooltip:move",tooltipKey,{mouseEvent:mouseEvent,data:data})}function hide(){$scope.$broadcast("sstooltip:hide",tooltipKey)}return{triggerOnScopeEvents:triggerOnScopeEvents,triggerOnDomEvents:triggerOnDomEvents,show:show,move:move,hide:hide}}}]),module});